### 2021.12.4
1. 修改了Serial模块，通信协议更改以适配步兵车上电控代码（暂时未测试）
2. 修改了ArmorDetectorm模块中的getPitchYaw函数，使用转换至陀螺仪的绝对角度送入KF


### 2021.12.12
上车调试后
1. 修复了ArmorDetector模块中getPitchYaw()返回pitch、yaw顺序反了的bug
2. 修复了yaw角度反了的bug（在Serial模块中对相应的data取反）

目前存在问题：
1. 程序运行时偶尔会有无法读取串口的问题
2. 陀螺仪读取时间到达固定值（电控代码问题,解决）
3. 发送数据频率过慢

待测试：
1. 将发送数据任务单独设置线程


### 2021.12.28
1. 陀螺仪数据插值有问题(需要运行一段时间后才能稳定插值, BUFFER 改大能优化)
1. 修复了ArmorDetector中的getPitchYaw错误使用solver结果（没加陀螺仪）进行预测的bug


### 2021.12.30
Bug修复：
1. 修复了云台跟踪断断续续的问题(shoot_code不能直接清0，应根据识别状态而定)

新增功能：
1. 记录视频功能（在Debug中开启）

待修复：
1. 串口有时无法正常读取数据
2. 角度结果有时过大
3. 陀螺仪数据插值需要一段时间后才能稳定

### 2022.1.14
修改：
1. 将原来的陀螺仪插值逻辑更改，选择使用最新获得的一次数据进行插值处理

待修复：
1. 串口有时无法正常读取数据

准备测试：
1. 卡尔曼滤波器参数调整对运动目标跟踪效果

### 2022.1.15
问题：
1. 陀螺仪发来的速度数据没有减速的概念，可能需要Python捕捉陀螺仪数据拟合曲线观察
2. 如果插值频繁失败会无法重置detctor状态，导致一直发送最后一帧数据。

修改：
1. 插值失败会重置数据
2. 在图像产生位置插值
3. 对错位数据进行修正操作

### 2022.1.16
问题&Bug修复：
1. 如果处理速度慢了可能导致发散，录像导致增加了12ms，ssh展示图片也会导致增加10ms左右，关闭后云台抖动消除

修改：
1. 如非必要，测试时关闭show和录像
2. 将Configure目录下的各种设置xml文件合并为Settings.xml
3. 现在在照片产生时进行陀螺仪数据匹配

### 2022.1.17
问题：
1. 如果在拍摄地方插入数据可能导致失败次数较多，在消费插入则失败次数较少


### 2022.2.13
更新：
1. 增加了打符模式，单独设置线程，未测试


### 2022.2.14
Bug修复：
1. 修复了RuneSolver模块初始化方向存在的Bug

### 2022.3.24 (随缘更新)
1. 弹道模型测试数值结果得出较合理的值，下一阶段准备进行实测

### 2022.12.25
1. 修改：
    大符拟合曲线中对振幅的拟合，按照用角度算出的拟合范围内的振幅，依照其四次方在总数的权值划分占比


### 2023.1.1
尝试新方法：线性卡尔曼滤波与最小二乘法
1. 尝试加入卡尔曼滤波,发现效果并不显著。数据变化更加平缓，�?�于极小值�?�理效果不好，spd大致变化范围(0.2~2.0)变为(0.7~1.6)，以致于无法进行准确的振幅拟合
2. 尝试使用最小二乘法拟合速度方程,去掉线性插值。结果表明所用时间是傅里叶变换方案的十倍，同时拟合效果并不如傅里叶变换。固定振幅a，其对角速度w与初相位t0的拟合不理想;固定a和w，其对t0的拟合也不理想
4. 尝试使用最小二乘法拟合角度方程。结果表明，a与t0的拟合效果并不理想,对w的拟合与傅里叶变换方案类似

### 2023.1.2
1. 修改：
    初相位t0的拟合,增加初相位采样数量;同时根据之前算出的w更新周期T

### 2023.1.4
1. 修改：
    线形插值的适用范围.初相位t0、振幅a的拟合采用原始数据fitting_data,角速度w拟合采用线形插值后的数据fitting_data_w

### 2023.1.12
1. 修改：
    之前的卡尔曼滤波直接使用滤波得到的速度，因速度方程未知而结果有很大偏差。对角度进行滤波得到滤波后的角度，再计算角速度。结果表明数据的拟合准确性有一定的提高。代码详见 Infantry-AutoInfantry-KF-improved.
2. 改进：
    之后的改进主要在初速度的实时更新、增加扩展卡尔曼滤波与粒子滤波。

### 2023.1.19
1. 新增：
    适应新比赛场景下的能量机关识别方案。具体步骤如下：
    1）图像预处理。沿袭上赛季方案。
    2）轮廓检测，并根据轮廓面积大小筛选并划分为内扇叶(in_vane)与外扇叶(out_vane)
    3) 内扇叶筛选：
        1.长短边之比
        2.轮廓与最小外接矩形面积之比
        3.角点数量，选择角点最多的轮廓作为待激活扇叶的内扇叶。
    4）外扇叶筛选：
        1.长短边之比
        2.轮廓与最小外接矩形面积之比
        3.内外扇叶最小外接矩形中心点距与内扇叶长边之比
        4.内外扇叶最小外接矩形角度之差的绝对值，选择内外扇叶最小外接矩形中心点距最小的轮廓作为待激活扇叶的内扇叶。
    5）确定圆心R坐标。沿袭上赛季方案。
    6）返回装甲板四个顶点：
        1.求出距离内扇叶外接矩形中心(O2)最近的外扇叶外接矩形两顶点(A,B)。
        2.求出距离外扇叶外接矩形中心(O1)最近的内扇叶外接矩形两顶点(C,D)。
        3.四顶点求和取平均得到装甲板中心点(O)。
        4.求出矢量O2O1到矢量OA,OB,OC,OD的旋转角，确定四点的位置顺序。
2. 问题与改进：
    1）待激活扇叶中轴线与坐标轴重合时无法识别物体。
    解决：一开始选用内外扇叶最小外接矩形角度之比作为筛选方案。中轴线与坐标轴重合时存在角度突变的情况，且情况较为复杂，故换成内外扇叶最小外接矩形角度之差的绝对值筛选外扇叶。
    2）待激活扇叶中轴线与坐标轴重合时出现顶点误选取的情况。
    解决：一开始选用OpenCV按照旋转矩形四顶点的位置关系返回装甲板四个顶点。待激活扇叶中轴线与坐标轴重合时内外扇叶最小外接矩形的顶点位置关系混乱，不方便讨论。