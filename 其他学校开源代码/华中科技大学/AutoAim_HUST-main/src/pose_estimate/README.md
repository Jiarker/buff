# 状态估计模块

[参考自哈工程自瞄系统](https://zhuanlan.zhihu.com/p/416449365)

以下分析该卡尔曼滤波与普通卡尔曼滤波的不同

1. CV运动模型，将位移和速度的过程噪声结合起来，将原本6x6的过程噪声矩阵变为3x3过程噪声矩阵，降低了调参量，同时保证了速度的合理性(如果单独设置过程噪声矩阵可能导致速度测量十分不准)。

2. 测量噪声矩阵我们是通过统计方法得到，通过不断晃动云台而保持目标装甲板位置不变，测出yaw,pitch,distance测量值的方差$\sigma_1,\sigma_2,\sigma_3 $，设置测量噪声矩阵对角线元素为$3\sigma_1^2,3\sigma_2^2,3\sigma_3^2$.

3. 将测量量转为yaw,pitch,distance三维，而不是x,y,z，这么转换的主要目的是为了更好地量化distance的测量噪声(因为PNP测距和距离有关)，而pitch,yaw的计算值和距离基本没有关系。

4. 卡方检验:用来检测装甲板切换.通常的装甲板切换算法可以简单设定为前后两帧装甲板的三维距离，设定三维距离阈值来判断装甲板切换。但是这种方法并未考虑速度元素，使用卡方检验相比距离检测更具备鲁棒性。